Option Explicit

Function OpenLink(Url)
  Dim oShellApp
  Set oShellApp = WScript.CreateObject("Shell.Application")
  oShellApp.ShellExecute Url,  "", "", "open", 1
  WScript.Echo "+ Opened url " & Url
End Function

Function KillAllProcs(processname)
  Dim oShellApp
  Set oShellApp = WScript.CreateObject("WScript.Shell")
  oShellApp.Run "taskkill /IM "+processname+" /F", ,True
  WScript.Echo "Killed processes named "+processname
End Function


'Setup Event Processing
Do While True
	WScript.Echo "Emulating some internet browsing..."
  OpenLink("http://onlineshopping.cysca")
  WScript.Sleep 10000
  OpenLink("http://talktofriends.cysca")
  WScript.Sleep 10000
  OpenLink("http://hipsterpics.cysca")
  WScript.Sleep 10000
  OpenLink("http://newsaggegator.cysca")
  WScript.Sleep 10000
  OpenLink("http://legitimatesite.cysca")
  'Sleep for 60 seconds
  WScript.Sleep 60000
  OpenLink("http://onlineshopping.cysca")
  WScript.Sleep 10000
  OpenLink("http://talktofriends.cysca")
  WScript.Sleep 10000
  OpenLink("http://hipsterpics.cysca")
  WScript.Sleep 10000
  OpenLink("http://newsaggegator.cysca")
  WScript.Sleep 10000
  OpenLink("http://legitimatesite.cysca")
  'Sleep for 60 seconds
  WScript.Sleep 60000
  'Close existing intances of IE
  WScript.Echo "Killing off IE processes"
  KillAllProcs("iexplore.exe")
  'Close any existing error reporting windows.
  KillAllProcs("werfault.exe")
  WScript.Sleep 5000
Loop
